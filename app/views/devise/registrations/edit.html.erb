<div class="row">
  <div class="col-col-md-10 mx-auto">
    <%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %>
      <%= devise_error_messages! %>

      <div class="form-group mx-auto col-md-10">
        <div class="row">
          <div class="col-4">
            <%= render_user_image resource, class: 'image_prev d-block mx-auto rounded-circle mb-3' %>
          </div>

          <div class="col-7 my-auto">
            <div class="custom-file">
              <%= f.file_field :image, class: 'custom-file-input image_field' %>
              <%= f.label :image, 'Update profile picture', class: 'custom-file-label' %>
            </div>
          </div>
        </div>
      </div>

      <%= render 'devise/registrations/common_fields', f: f, countries: @countries.collect{ |country| [country.name, country.id] } %>

      <div class="form-group">
        <p class="form-text text-muted"><small>Leave password blank if you don't want to change it</small></p>

        <%= f.password_field :password, autocomplete: "off", class: 'form-control', placeholder: 'Password'  %>
      </div>

      <div class="form-group">
        <%= f.password_field :password_confirmation, autocomplete: "off", class: 'form-control', placeholder: 'Confirm Password'  %>
      </div>

      <div class="form-group">
        <p class="form-text text-muted"><small>We need your current password to confirm your changes</small></p>

        <%= f.password_field :current_password, autocomplete: "off", class: 'form-control', placeholder: 'Current Password'  %>
      </div>

      <div class="col-12">
        <hr class="mt-2 mb-3">
        <div class="d-flex flex-wrap justify-content-between align-items-center">
          <%= link_to "Deactivate my account", registration_path(resource_name), data: { confirm: "Are you sure? You cannot undo this." }, method: :delete, class: 'btn btn-danger' %>

          <%= f.submit "Save Changes", class: 'btn btn-primary margin-right-none' %>
        </div>
      </div>
    <% end %>
  </div>
</div>

<% content_for :js_init do %>
  Image.init_preview();
<% end %>
