<div class="persisted-data"
     data-url="<%= price_details_lodging_path(lodging) %>"
     data-validate-url="<%= validate_reservations_path %>">
</div>

<div class="row price_box">
  <div class="col-md-12 col-sm-12 col-lg-12 pr-0">
    <%= form_for reservation, url: reservations_path, remote: true, html: { id: "new_reservation#{id_sufix}" } do |f| %>
      <h4 class="margin-bottom-1x">Check Availability & Reserve</h4>
      <div class="reservation-form-errors-<%= lodging.id %>">
        <%= render 'reservations/errors', resource: reservation %>
      </div>

      <div class="vue-app">
        <div>
          <reservation-datepicker
            :check-in="'<%= params[:check_in]%>'"
            :check-out="'<%= params[:check_out]%>'"
            :check-in-title="'<%= t('search.check_in') %>'"
            :check-out-title="'<%= t('search.check_out') %>'"
            :months="1"
            :min-date="'<%= Date.yesterday %>'"
            :lodging-id="<%= lodging.id %>"
            :disabled-dates="<%= lodging.not_available_on %>"
            :customized-dates="<%= lodging.customized_dates %>"
            :invoice-on-apply= "true"
          />
        </div>

        <div>
          <guests-dropdown
            :adults="<%= no_of_adults(params[:adults] || 1) %>"
            :children="<%= params[:children] || 0 %>"
            :infants="<%= params[:infants] || 0 %>"
            :adults-target="'.adults'"
            :children-target="'.children'"
            :infants-target="'.infants'"
            :dropdown-id="'<%= "guests-dropdown-#{lodging.id}#{id_sufix}" %>'"
            :show-apply="true"
          />
        </div>
      </div>

      <%= render 'shared/alert', title: 'Important:', description: t('not_live_parent'), type: 'info' unless lodging.checked? %>

      <%= f.hidden_field :adults, value: no_of_adults(params[:adults] || f.object.adults), class: 'adults', id: "adults_#{lodging.id}#{id_sufix}" %>
      <%= f.hidden_field :children, value: (params[:children] || f.object.children), class: 'children', id: "children_#{lodging.id}#{id_sufix}" %>
      <%= f.hidden_field :infants, value: (params[:infants] || f.object.infants), class: 'infants', id: "infants_#{lodging.id}#{id_sufix}" %>
      <%= f.hidden_field :lodging_id, value: lodging.id, id: "lodging_id_#{lodging.id}#{id_sufix}" %>

      <%= f.hidden_field :check_in, value: params[:check_in], id: "check_in_#{lodging.id}#{id_sufix}", class: 'check_in' %>
      <%= f.hidden_field :check_out, value: params[:check_out], id: "check_out_#{lodging.id}#{id_sufix}", class: 'check_out' %>
      <%= f.hidden_field :cleaning_cost, id: "cleaning_cost_#{lodging.id}#{id_sufix}", class: 'cleaning-cost' %>
      <%= f.hidden_field :discount, id: "discount_#{lodging.id}#{id_sufix}", class: 'discount' %>

      <div class="text-center pt-2">
        <% [:prebooking, :option].each do |status| %>
        <%= f.radio_button :booking_status, status, id: "booking_status_#{status}_#{lodging.id}#{id_sufix}" %>
          <label><%= t("reservations.#{status}") %></label>
        <% end %>
        <p id="lbl-error-<%= "#{lodging.id}#{id_sufix}" %>"></p>
        <div class="text-dark text-left line-height-2" id="bill-<%= "#{lodging.id}#{id_sufix}" %>"></div>
        <%= f.submit t('cart.shopping_cart'), class: "btn btn-primary btn ml-0 col-md-12 btn-booking disabled", id: "cart-#{lodging.id}#{id_sufix}" %>
          <%= render 'wishlists/form',  lodging: lodging %>
          <p class="extra_small text-center"><%= t 'cart.nice2stay' %></p>
        <%= render 'shared/alert', title: 'Important:', type: 'info', description: t('prices_not_confirmed') unless lodging.confirmed_price %>
      </div>
    <% end %>
  </div>
  <%= render 'shared/alert', title: 'Important:', type: 'info', description: t('prices_not_confirmed') unless lodging.confirmed_price %>
</div>
