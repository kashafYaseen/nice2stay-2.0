<div class="persisted-data"
    data-url="<%= price_details_lodging_path(lodging) %>"
    data-validate-url="<%= validate_reservations_path %>">
</div>

<div class="row <%= 'pl-4' unless id_sufix.present? %>">
  <div class="col-md-12 <%= 'container' unless id_sufix.present? %>">
    <% if id_sufix.present? %>
      <h4 class="margin-bottom-1x form-heading"><%= t 'cart.availability' %></h4>
    <% end %>

    <div class="row" data-lodging-id="<%= lodging.id %>">
      <div class="vue-app" data-id="vue_datepicker<%= id_sufix %>">
        <reservation-datepicker
          :check-in="'<%= params[:check_in].presence || Date.today %>'"
          :check-out="'<%= params[:check_out].presence || 7.days.from_now %>'"
          :check-in-title="'<%= t('search.check_in') %>'"
          :check-out-title="'<%= t('search.check_out') %>'"
          :months="2"
          :lodging-id="<%= lodging.id %>"
          :disabled-dates="<%= lodging.children_not_available_on %>"
          :min-date="'<%= Date.today %>'"
          :customized-dates="<%= lodging.customized_dates %>"
          :trigger-id="'<%= "datepicker-trigger-#{lodging.id}#{id_sufix}" %>'"
          :show-action-buttons="false"
          :inline="false"
          :bind-with="'<%= id_sufix.present? ? "vue_datepicker" : "vue_datepicker_modal" %>'"
        />
      </div>

      <div class="vue-app" data-id="vue_guest_dropdown<%= id_sufix %>">
        <guests-dropdown
          :adults="<%= no_of_adults(params[:adults].to_i) %>"
          :children="<%= params[:children].to_i %>"
          :infants="<%= params[:infants].to_i %>"
          :adults-target="'.adults'"
          :children-target="'.children'"
          :infants-target="'.infants'"
          :dropdown-id="'<%= "guests-dropdown-#{lodging.id}#{id_sufix}" %>'"
          :show-apply="false"
          :button-classes="'btn btn-outline-primary dropdown-toggle'"
          :max-adults="20"
          :max-children="20"
          :max-infants="20"
          :bind-with="'<%= id_sufix.present? ? "vue_guest_dropdown" : "vue_guest_dropdown_modal" %>'"
        />
      </div>

      <%= form_for reservation, url: lodging_guest_centric_offer_path(lodging), remote: true, method: :get, html: { id: "new_reservation#{id_sufix}" } do |f| %>

        <%= f.hidden_field :check_in, value: params[:check_in].presence || Date.today, id: "check_in#{id_sufix}", class: 'check_in' %>
        <%= f.hidden_field :check_out, value: params[:check_out].presence || 7.days.from_now, id: "check_out#{id_sufix}", class: 'check_out' %>
        <%= f.hidden_field "adults#{id_sufix}", value: no_of_adults(params[:adults] || f.object.adults), class: 'adults' %>
        <%= f.hidden_field "children#{id_sufix}", value: (params[:children] || f.object.children), class: 'children' %>
        <%= f.hidden_field "infants#{id_sufix}", value: (params[:infants] || f.object.infants), class: 'infants' %>
        <%= f.hidden_field "lodging_id#{id_sufix}", value: lodging.id %>

        <%= f.submit('Check Availability', class: "btn btn-primary") %>
      <% end %>
    </div>
  </div>
</div>
